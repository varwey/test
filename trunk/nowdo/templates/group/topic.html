{% extends "layout/layout.html" %}

{% block content %}

    <div class="panel panel-default panel-content">
        <div class="panel-heading">
            <h1>
                {{ topic.title }}
                <span class="topic-meta">
                    {{ topic.created_date|delta }}，
                    <span class="dropdown">
                        <a data-toggle="dropdown" href="#">
                            分享
                            <i class="fa fa-share"></i>
                        </a>
                        <ul class="dropdown-menu">
                            <li>
                                <a href="#">
                                    微博
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    微信
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    QQ空间
                                </a>
                            </li>
                        </ul>
                    </span>
                </span>
            </h1>
        </div>
        <div class="panel-body">
            {{ topic.content|safe }}
        </div>
    </div>


{#    <div class="media media-topic">#}
{#        <a class="pull-left" href="#">#}
{#            <img class="media-object" src="{{ topic.creator.avatar_url }}" alt="{{ topic.creator }}">#}
{#        </a>#}
{#        <div class="media-body">#}
{#            <div class="media-heading">#}
{#                来自：#}
{#                <a href="{{ url_for('personal.index', user_id=topic.creator.id) }}" class="topic-author-link">#}
{#                    {{ topic.creator.display_name or topic.creator.email }}#}
{#                </a>#}
{#                <span class="text-success">#}
{#                    {{ topic.created_date }}#}
{#                </span>#}
{#            </div>#}
{#            <div class="media-content">#}
{#                {{ topic.content|safe }}#}
{#            </div>#}
{#        </div>#}
{#    </div>#}

    <div class="panel panel-default panel-comment-form" id="comments">
        <div class="panel-heading">
            评论
        </div>
        <div class="panel-body">
            <form action="{{ url_for('group.create_comment', topic_id=topic.id) }}" method="post">
                {{ comment_form.csrf_token }}
                {{ comment_form.comment_id }}
                <div>
                    {{ comment_form.content(class='form-control', placeholder='请填入你要评论的内容...', rows='4') }}
                </div>
                <div class="clearfix">
                    <button type="submit" class="btn btn-primary pull-right">发表观点</button>
                </div>
            </form>
        </div>
    </div>

    <div class="panel panel-default panel-comment-list">
        {% if topic.comments %}
        <div class="panel-body">
            <ul class="media-list">
                {% for c in topic.comments %}
                    <li class="media media-comment" id="comment{{ c.id }}">
                        <a class="pull-left" href="{{ url_for('personal.index', user_id=c.creator_id) }}">
                            <img class="media-object" src="{{ c.creator.avatar_url }}" alt="{{ c.creator.nickname }}">
                        </a>
                        <div class="media-body">
                            <div class="media-heading">
                                <a href="{{ url_for('personal.index', user_id=c.creator_id) }}" class="author-link">
                                    {{ c.creator.nickname }}
                                </a>
                                <span class="pull-right">
                                    {{ c.created_date }}
                                </span>
                            </div>
                            {{ c.content }}
                        </div>
                    </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
    </div>
{% endblock %}

{% block sidebar %}
    {{ macros.render_user_profile_card(topic.creator) }}
    <button type="submit" class="btn btn-primary form-control bottom-gap">立即参与</button>
{% endblock %}