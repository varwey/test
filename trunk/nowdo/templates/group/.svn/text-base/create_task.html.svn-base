{% extends 'layout/layout.html' %}
{% block content %}

    {{ macros.render_publisher(form, url_for('group.create_task', group_id=group.id)) }}

{#    {% call macros.render_panel_content(h1_title='发布一个新主题') %}#}
{#        <form action="{{ url_for('group.create_task', group_id=group.id) }}"#}
{#              method="post"#}
{#              enctype="multipart/form-data">#}
{#            {{ form.csrf_token }}#}
{#            <div class="form-group">#}
{#                {{ form.task_name.label }}#}
{#                {{ form.task_name(class="form-control") }}#}
{#            </div>#}
{#            <div class="form-group">#}
{#                {{ form.task_description.label }}#}
{#                {{ form.task_description(class="form-control") }}#}
{#            </div>#}
{#            <div class="form-group">#}
{#                {{ form.max_translate_count.label }}#}
{#                {{ form.max_translate_count(class="form-control", value="50") }}#}
{#            </div>#}
{#            <div class="form-group">#}
{#                {{ form.src_lang.label }}#}
{#                {{ form.src_lang(class="form-control") }}#}
{#            </div>#}
{#            <div class="form-group">#}
{#                {{ form.tar_lang.label }}#}
{#                {{ form.tar_lang(class="form-control") }}#}
{#            </div>#}
{#            <div class="form-group">#}
{#                {{ form.glossary_table.label }}#}
{#                {{ form.glossary_table(class="form-control") }}#}
{#            </div>#}
{#            <div class="form-group">#}
{#                <a class="change-input-mode pull-right" href="javascript:void(0);">#}
{#                    {{ '手动输入' if form.input_mode.data == 'file' else '文件输入' }}#}
{#                </a>#}
{#                {{ form.input_mode() }}#}
{#                <div class="file-input" {% if form.input_mode.data == 'text' %}style="display: none;"{% endif %}>#}
{#                    {{ form.task_file.label }}#}
{#                    {{ form.task_file(class="form-control") }}#}
{#                </div>#}
{#                <div class="text-input" {% if form.input_mode.data == 'file' %}style="display: none;"{% endif %}>#}
{#                    {{ form.task_content.label }}#}
{#                    {{ form.task_content(class="form-control", rows='10') }}#}
{#                </div>#}
{#            </div>#}
{#            <div class="form-group">#}
{#                {{ form.tags.label }}#}
{#                {{ form.tags(class="form-control", placeholder='标签，多个标签用逗号分隔') }}#}
{#            </div>#}
{#            <div class="form-group">#}
{#                    <label class="checkbox" for="status">{{ form.status(checked='checked') }}立即开启</label>#}
{#            </div>#}
{#            {% if form.errors %}#}
{#                <div class="alert alert-danger">#}
{#                    {% for label, error_list in form.errors.iteritems() %}#}
{#                        <p>{{ error_list[0] }}</p>#}
{#                    {% endfor %}#}
{#                </div>#}
{#            {% endif %}#}
{#            <div class="form-group">#}
{#                <button type="submit" class="btn btn-primary">提交</button>#}
{#            </div>#}
{#        </form>#}
{#    {% endcall %}#}

{% endblock %}

{% block sidebar %}
    <a class="bottom-gap btn btn-primary" href="{{ url_for('group.group_home', group_id=group.id) }}">回到：{{ group.group_name }}</a>

    {% call macros.render_panel_xc('友情提示') %}
        <div class="panel-body">
            考虑到中国法律法规和相关政策的要求,脑洞不欢迎色情、激进话题、意识形态方面的讨论, 并保留删除这类主题的权利。
        </div>
    {% endcall %}
{% endblock %}

{% block extra_js %}
    <script type="text/javascript">
        seajs.use(['nowdo', '$'], function(nowdo, $){
            $(function(){
                new nowdo.publisher.PublisherView().options({
                    redirect: '{{ url_for('group.group_home', group_id=group.id) }}'
                }).toggleTextEditor();
{#                $('.change-input-mode').click(function(){#}
{#                    var $target = $(this),#}
{#                        input_mode_field = $('#input_mode'),#}
{#                        input_mode = input_mode_field.val();#}
{#                    if(input_mode === 'text'){#}
{#                        $('.text-input').fadeOut(function(){#}
{#                            $('.file-input').fadeIn();#}
{#                            input_mode_field.val('file');#}
{#                            $target.text('手动输入');#}
{#                        });#}
{#                    }else{#}
{#                        $('.file-input').fadeOut(function(){#}
{#                            $('.text-input').fadeIn();#}
{#                            input_mode_field.val('text');#}
{#                            $target.text('文件输入');#}
{#                        });#}
{#                    }#}
{#                });#}
            });
        });
    </script>
{% endblock %}
